<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>plesk won't start after tweaking mysql - Jon Doblados</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://jon.doblados.net/plesk-wont-start-after-tweaking-mysql.html">

        <meta name="author" content="jon" />
        <meta name="keywords" content="Hosting,MySQL" />
        <meta name="description" content="i&#39;ve had this happen to me again the other week and as always, felt like kicking myself for not remembering. we do a lot of performance tuning on mysql, and as a result, we almost always manage to get plesk mangled. not its fault, it just can&#39;t run ..." />

    <!-- Enable latex plugin -->




    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://jon.doblados.net/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://jon.doblados.net/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://jon.doblados.net/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="http://jon.doblados.net/theme/css/style.css" type="text/css"/>




</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://jon.doblados.net/" class="navbar-brand">
Jon Doblados            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://jon.doblados.net/pages/about.html">
                             About
                          </a></li>
                         <li><a href="http://jon.doblados.net/pages/contact.html">
                             Contact
                          </a></li>
                        <li >
                            <a href="http://jon.doblados.net/category/aside.html">Aside</a>
                        </li>
                        <li >
                            <a href="http://jon.doblados.net/category/gbg.html">Gbg</a>
                        </li>
                        <li class="active">
                            <a href="http://jon.doblados.net/category/misc.html">Misc</a>
                        </li>
                        <li >
                            <a href="http://jon.doblados.net/category/python.html">Python</a>
                        </li>
                        <li >
                            <a href="http://jon.doblados.net/category/tech.html">Tech</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://jon.doblados.net/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://jon.doblados.net/plesk-wont-start-after-tweaking-mysql.html"
                       rel="bookmark"
                       title="Permalink to plesk won't start after tweaking mysql">
                        plesk won't start after tweaking mysql
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2007-08-14T04:09:00+08:00"> Tue 14 August 2007</time>
    </span>






<span class="label label-default">Tags</span>
	<a href="http://jon.doblados.net/tag/hosting.html">Hosting</a>
        /
	<a href="http://jon.doblados.net/tag/mysql.html">MySQL</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>i've had this happen to me again the other week and as always, felt like
kicking myself for not remembering.</p>
<p>we do a lot of performance tuning on mysql, and as a result, we almost
always manage to get plesk mangled. not its fault, it just can't run
without mysql, doh.</p>
<p>not of preference, but plesk happens to be there to make handling
domains easier, as a single editing point when you want to change
something and not worry about missing something out.</p>
<p>so there's a custom /etc/my.cnf that we use, and with changes to limits
done (both on mysql and via ulimit), you'd think that a reload of mysqld
would do. (we use InnoDB btw)</p>
<p>normally, that's all you need to have mysqld read off the new settings.
if you've grown so dependent on plesk (like i have), you would not
notice that mysqld didn't actually start, and you will get an error when
you load plesk, thinking that it's a plesk error:</p>
<p><code>ERROR: PleskMainDBExceptionMySQL query failed: Incorrect information in file: './psa/misc.frm'</code></p>
<p>0: /usr/local/psa/admin/plib/common_func.php3:218<br />
db_query(string 'select param, val from misc')<br />
1: /usr/local/psa/admin/plib/common_func.php3:497<br />
get_param(string 'mysql41_compatible')<br />
2: /usr/local/psa/admin/plib/common_func.php3:394<br />
db_set_names()<br />
3: /usr/local/psa/admin/plib/common_func.php3:373<br />
db_connect_real(string 'localhost', string 'admin', string
'********', string 'psa')<br />
4: /usr/local/psa/admin/plib/common_func.php3:353<br />
db_connect()<br />
5: /usr/local/psa/admin/auto_prepend/auth.php3:82<br />
</code></p>
<p>even a restart of the plesk service will not work:</p>
<p><code>[root@jedi]# /etc/init.d/psa restartUnable to query parameter by query select val from misc where param='mysql41_compatible': Incorrect information in file: './psa/misc.frm'Unable to query parameter by query select val from misc where param='mysql41_compatible': Incorrect information in file: './psa/misc.frm'Mysql error: Incorrect information in file: './psa/key_history.frm'Processing config directory: /usr/local/psa/admin/conf/httpsd.*.includeSyntax OK/usr/local/psa/admin/bin/httpsdctl restart: httpd restartedERROR 1033 (HY000) at line 1: Incorrect information in file: './psa/sessions.frm'</code></p>
<p>so this is a mysqld failing to start properly problem. to fix this, go
to your mysql datadir and see if the sizes of your innodb log files
match those in your .cnf. we usually set innodb_log_file_size = 256M
and innodb_log_buffer_size = 256M in /etc/my.cnf.</p>
<p>if they don't match, stop mysqld, remove the ib_logfile0 and
ib_logfile1 files, and start mysqld. be careful not to delete the
ibdata1 or ibdata2 files or you lose your data. avoid using rm -r ib*
(yea, wildcards and fast fingers give sysads their most stupefying
moments)</p>
<p>innodb will recreate the log files to match your .cnf and mysqld now
becomes available for plesk.</p>
</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'jondoblados'; // required: replace example with your forum shortname

                    var disqus_identifier = 'plesk-wont-start-after-tweaking-mysql';
                var disqus_url = 'http://jon.doblados.net/plesk-wont-start-after-tweaking-mysql.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item"><a href="http://twitter.com/JonDoblados"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
                    <li class="list-group-item"><a href="http://plus.google.com/+JonDoblados"><i class="fa fa-google-plus-square fa-lg"></i> Google+</a></li>
                  </ul>
                </li>



                <li class="list-group-item"><a href="http://jon.doblados.net/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group " id="tags">
                        <li class="list-group-item tag-1">
                            <a href="http://jon.doblados.net/tag/family.html">
                                Family
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jon.doblados.net/tag/miguel.html">
                                Miguel
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jon.doblados.net/tag/technology.html">
                                Technology
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jon.doblados.net/tag/personal.html">
                                Personal
                            </a>
                        </li>
                        <li class="list-group-item tag-1">
                            <a href="http://jon.doblados.net/tag/systems-administration.html">
                                Systems Administration
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/galleries.html">
                                Galleries
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/photos.html">
                                Photos
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/hosting.html">
                                Hosting
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/gbg-cagayan-de-oro.html">
                                GBG Cagayan de Oro
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/gnulinux.html">
                                GNU/Linux
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/christianity-amp-parenthood.html">
                                Christianity amp; Parenthood
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/gbg.html">
                                GBG
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/kysa.html">
                                Kysa
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/community-work.html">
                                Community Work
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/ubuntu.html">
                                Ubuntu
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/google.html">
                                Google
                            </a>
                        </li>
                        <li class="list-group-item tag-2">
                            <a href="http://jon.doblados.net/tag/vacation.html">
                                Vacation
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/ibm.html">
                                IBM
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/cebu.html">
                                Cebu
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/preschool.html">
                                Preschool
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/nix.html">
                                *nix
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/cloud-computing.html">
                                Cloud Computing
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/hong-kong.html">
                                Hong Kong
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/mysql.html">
                                MySQL
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/gallery.html">
                                Gallery
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/christianity.html">
                                Christianity
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/blogging.html">
                                Blogging
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/todo.html">
                                TODO
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/data-center.html">
                                Data Center
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/selfie.html">
                                Selfie
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/aside.html">
                                Aside
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/hci.html">
                                HCI
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/god.html">
                                God
                            </a>
                        </li>
                        <li class="list-group-item tag-3">
                            <a href="http://jon.doblados.net/tag/image.html">
                                Image
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/rds.html">
                                RDS
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/office.html">
                                Office
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/isabel.html">
                                Isabel
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/parenting.html">
                                Parenting
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/bug-tracking.html">
                                Bug Tracking
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/tech.html">
                                Tech
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/victorycdo.html">
                                VictoryCDO
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/jesus-christ.html">
                                Jesus Christ
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/domains.html">
                                Domains
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/cloud.html">
                                Cloud
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/honda.html">
                                Honda
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/revision-control.html">
                                Revision Control
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/pelican.html">
                                Pelican
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/writing.html">
                                Writing
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/virtualization.html">
                                Virtualization
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/ec2.html">
                                EC2
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/gwf.html">
                                GWF
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/civic.html">
                                Civic
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/rs6000-b50.html">
                                RS6000 B50
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/victory.html">
                                Victory
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/valentines-day.html">
                                Valentines Day
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/xavier-u.html">
                                Xavier U
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/sysads.html">
                                Sysads
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/community.html">
                                Community
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/relationships.html">
                                Relationships
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/github.html">
                                GitHub
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/marriage.html">
                                Marriage
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/cdo.html">
                                CDO
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/katrina.html">
                                Katrina
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/hp.html">
                                HP
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/risc.html">
                                RISC
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/python.html">
                                Python
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/crystal-reports.html">
                                Crystal Reports
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/parenthood.html">
                                Parenthood
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/christmas.html">
                                Christmas
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/map-maker.html">
                                Map Maker
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/oracle.html">
                                Oracle
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/openstack.html">
                                OpenStack
                            </a>
                        </li>
                        <li class="list-group-item tag-4">
                            <a href="http://jon.doblados.net/tag/oracle-bi.html">
                                Oracle BI
                            </a>
                        </li>
                    </ul>
                </li>    


    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://getpelican.com/" target="_blank">
                Pelican
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://python.org/" target="_blank">
                Python.org
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://jinja.pocoo.org/" target="_blank">
                Jinja2
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Jon
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://jon.doblados.net/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://jon.doblados.net/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://jon.doblados.net/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'jondoblados'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
</body>
</html>