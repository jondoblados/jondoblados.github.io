<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="jon" />
        <meta name="keywords" content="GNU/Linux,Hosting,Systems Administration" />
        <meta name="description" content="I was looking for a quick and painless way to determine what IP addresses used our web app the most and stumbled across this excellent post. I got reminded of the power of the command-line interface and that often, I underestimate the way these commands are supposed to make a ..." />

    <title>How to count instances of an IP address in a log file - Jon Doblados</title>

        <link rel="stylesheet" href="http://jon.doblados.net/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://jon.doblados.net/theme/css/font-awesome.min.css" rel="stylesheet">
    
    <link href="http://jon.doblados.net/theme/css/pygments/native.css" rel="stylesheet">
    
    <link href="/theme/css/pelican-twitchy.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Feeds -->
</head>
<body data-spy="scroll" data-target="#scrollspy">
    <div id="wrapper">
        <!-- Sidebar -->
        <div id="sidebar-wrapper-small">
            <ul id="accordion-small" class="sidebar-nav sidebar-nav-small">
                <li>
        <a href="http://jon.doblados.net" title="Jon Doblados" class="collapsed">
            <span class="glyphicon glyphicon-home"></span>
        </a>
    </li>
                <li class="nav-divider"></li>
                <li>
        <a href="http://jon.doblados.net/archives.html" title="Recent Articles" class="collapsed">
            <span class="glyphicon glyphicon-th-list"></span>
        </a>
    </li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion-small" href="#collapse-social-small" title="Social" class="collapsed">
                        <i class="fa fa-users padding-small"></i>
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social-small" class="collapse ">
                    <li>
                        <a href="http://facebook.com/JonDoblados" title="Facebook"><i class="fa fa-facebook-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="http://plus.google.com/+JonDoblados" title="Google+"><i class="fa fa-google-plus-square fa-lg padding-small"></i></a>
                    </li>
                    <li>
                        <a href="http://twitter.com/JonDoblados" title="Twitter"><i class="fa fa-twitter-square fa-lg padding-small"></i></a>
                    </li>
                </ul></li>
                <li class="nav-divider"></li>
                <li>
        <a href="#" title="Back to top" class="collapsed">
            <span class="fa fa-arrow-up"></span>
        </a>
    </li>
            </ul>
        </div>
        <div id="sidebar-wrapper">
            <ul id="accordion" class="sidebar-nav">
                <li class="sidebar-brand">
                    <a href="http://jon.doblados.net/">
                            <span class="glyphicon glyphicon-home padding-small"></span>
                            Jon Doblados
                    </a>
                </li>
                    <li>
                        <a href="http://jon.doblados.net/archives.html">
                            <span class="glyphicon glyphicon-th-list padding-small"></span>
                            Recent Articles
                        </a>
                    </li>
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-social">
                        <i class="fa fa-users padding-small"></i>
                        Social
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-social" class="sidebar_submenu collapse ">
                    <li>
                        <a href="http://facebook.com/JonDoblados" title="Facebook">
                            <i class="fa fa-facebook-square fa-lg padding-small"></i>
                            Facebook
                        </a>
                    </li>
                    <li>
                        <a href="http://plus.google.com/+JonDoblados" title="Google+">
                            <i class="fa fa-google-plus-square fa-lg padding-small"></i>
                            Google+
                        </a>
                    </li>
                    <li>
                        <a href="http://twitter.com/JonDoblados" title="Twitter">
                            <i class="fa fa-twitter-square fa-lg padding-small"></i>
                            Twitter
                        </a>
                    </li>
                </ul></li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-pages">
                        <i class="fa fa-folder-open padding-small"></i>
                        Pages
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-pages" class="sidebar_submenu collapse ">
                    <li>
                        <a href="http://jon.doblados.net/pages/about.html">
                            <i class="fa fa-file-text padding-small"></i>
                            About
                        </a>
                    </li>
                    <li>
                        <a href="http://jon.doblados.net/pages/contact.html">
                            <i class="fa fa-file-text padding-small"></i>
                            Contact
                        </a>
                    </li>
                </ul></li>
                
                <li class="nav-divider"></li>
                <li>
                    <a data-toggle="collapse" data-parent="#accordion" href="#collapse-categories">
                        <i class="fa fa-folder-open padding-small"></i>
                        Categories
                    </a>
                </li>
                <li class="panel anti-panel"><ul id="collapse-categories" class="sidebar_submenu collapse ">
                    <li >
                        <a href="http://jon.doblados.net/category/aside.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            Aside
                            <span class="badge pull-right categorybadge">1</span>
                        </a>
                    </li>
                    <li >
                        <a href="http://jon.doblados.net/category/gbg.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            GBG
                            <span class="badge pull-right categorybadge">1</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="http://jon.doblados.net/category/misc.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            Misc
                            <span class="badge pull-right categorybadge">211</span>
                        </a>
                    </li>
                    <li >
                        <a href="http://jon.doblados.net/category/python.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            Python
                            <span class="badge pull-right categorybadge">1</span>
                        </a>
                    </li>
                    <li >
                        <a href="http://jon.doblados.net/category/tech.html">
                            <i class="fa fa-folder-open padding-small"></i>
                            Tech
                            <span class="badge pull-right categorybadge">13</span>
                        </a>
                    </li>
                </ul></li>
                
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->
        <!-- open/close sidebar -->
        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">
            <span id="right-arrow" class="glyphicon glyphicon-chevron-right"  title="expand sidebar"></span>
            <span id="left-arrow" class="glyphicon glyphicon-chevron-left" title="minimize sidebar"></span>
        </a>
       <!-- /open/close sidebar -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container">
<section id="content">
    <article>
        <div class="row">
            <div class="col-lg-12">
                <header class="page-header">
                    <h1>
                        <a href="http://jon.doblados.net/how-to-count-instances-of-an-ip-address-in-a-log-file.html"
                           rel="bookmark"
                           title="Permalink to How to count instances of an IP address in a log file">
                            How to count instances of an IP address in a log file
                        </a>
                        <small>
<footer class="post-info">
    <div id="publish-info" class="publish-info-block">
        <span class="published">
            <i class="fa fa-calendar padding-small"></i><time datetime="2010-07-24T12:00:00+08:00"> Sat 24 July 2010</time>
        </span>
        <span class="category">
            <i class="fa fa-folder-open padding-small"></i><a href="http://jon.doblados.net/category/misc.html">misc</a>
        </span>
        <span class="tags">
            <i class="fa fa-tags padding-small"></i>
            <a href="http://jon.doblados.net/tag/gnulinux.html">GNU/Linux</a> /             <a href="http://jon.doblados.net/tag/hosting.html">Hosting</a> /             <a href="http://jon.doblados.net/tag/systems-administration.html">Systems Administration</a>        </span>
    </div>
</footer><!-- /.post-info -->                        </small>
                    </h1>
                </header>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="entry-content">
                    <p>I was looking for a quick and painless way to determine what IP
addresses used our web app the most and stumbled across this excellent
<a href="http://encodable.com/tech/blog/2008/12/17/Count_IP_Addresses_in_Access_Log_File_BASH_OneLiner">post</a>.Â I
got reminded of the power of the command-line interface and that often,
I underestimate the way these commands are supposed to make a sysad's
life easier.</p>
<p>So here's a quick tip for counting unique visitors to your web app.
Locate your web app's log file and do a quick scan of the last few
lines. In my case, this is what I saw:</p>
<p><code>112.198.79.223 - - [10/Jul/2010:00:57:29 -0400] "POST /v2/api/execute.php?method=upload_time&amp;ver=win1.1.15 HTTP/1.1" 200 116 "-" "Mozilla/5.0"117.241.112.254 - - [10/Jul/2010:00:57:30 -0400] "POST /v2/api/execute.php?method=timestat&amp;ver=win1.1.15 HTTP/1.1" 200 288 "-" "Mozilla/5.0"80.249.84.105 - - [10/Jul/2010:00:57:29 -0400] "POST /v2/api/execute.php?method=offtime&amp;ver=win1.1.15 HTTP/1.1" 200 19 "-" "Mozilla/5.0"117.241.112.254 - - [10/Jul/2010:00:57:32 -0400] "POST /v2/api/execute.php?method=get_defaults&amp;ver=win1.1.15 HTTP/1.1" 200 77 "-" "Mozilla/5.0"</code></p>
<p>In this log format, the IP address appears first, so we will only need
to get the first set of characters, separated by a space. In order to
count instances of an IP address, we sort the IP addresses so similar IP
addresses are grouped together, then count them. Then we sort them again
so that the sums are arranged. The number of unique IPs may give you
pages of standard output, so optionally, if you only want to see which
IP addresses accessed the web app the most, we look at the top results
only.</p>
<p>So these are the commands used, piped one after the other, with the
output:</p>
<p><code>[root@server2 ~]# cat /var/log/httpd/access_ssl.log | awk '{print $1}' | sort | uniq -c | sort -nr | head&gt;</code></p>
<p><code>71612 216.157.78.237 34094 120.28.205.244 30091 119.93.97.54 25078 120.28.214.104 18949 120.28.195.151 17929 58.107.64.40 14877 212.98.174.235 14752 117.241.112.143 14429 120.28.247.74 12864 117.241.113.183 [root@server2 ~]#</code></p>
<p>Happy counting, err reporting!</p>
                </div>
                <footer class="text-right">
                    <p>- jon</p>
                </footer>
    <section id="comments" class="comments ">
        <hr/>
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </section>
            </div>
        </div>
    </article>
</section>
            </div>
<footer>
    <div class="container-fluid">
        <hr>
        <div class="row">
            <div class="col-xs-4 text-left">
                
            </div>
            <div class="col-xs-8 text-right">
                <p>Built using <a href="http://docs.getpelican.com/en/latest">Pelican</a>, <a href="getbootstrap.com">Bootstrap3</a> and the <a href="https://github.com/ingwinlu/pelican-twitchy">pelican-twitchy</a> theme.</p>
                <p>&copy; 2015 Jon</p>
            </div>
        </div>
    </div>
</footer>        </div>
        <!-- /#page-content-wrapper -->
    </div>
    <!-- /#wrapper -->
    <!-- jQuery Version 1.11.0 -->
    <script src="/theme/js/jquery-1.11.0.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/theme/js/bootstrap.min.js"></script>
    <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>


<!-- disqus -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'jondoblados'; // required: replace example with your forum shortname

            var disqus_identifier = 'how-to-count-instances-of-an-ip-address-in-a-log-file';
        var disqus_url = 'http://jon.doblados.net/how-to-count-instances-of-an-ip-address-in-a-log-file.html';

    var disqus_config = function () {
        this.language = "en";
    };
        /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<!-- /disqus --></body>
</html>