<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
        <title>Jon Doblados &middot; articles tagged "MySQL"</title>
        <link rel="shortcut icon" href="http://jon.doblados.net/favicon.ico" />

        <link rel="stylesheet" href="http://jon.doblados.net/theme/css/screen.css" type="text/css" />
        <link rel="stylesheet" href="http://jon.doblados.net/theme/css/pygments.css" type="text/css" />
    </head>
    <body>
<div id="header">
            <ul id="nav">
                <li class="ephemeral selected"><a href="http://jon.doblados.net/tag/mysql.html">MySQL</a></li>
                <li><a href="http://jon.doblados.net">Home</a></li>
<li><a href="http://jon.doblados.net/pages/about.html">About</a></li>
<li><a href="http://jon.doblados.net/pages/contact.html">Contact</a></li>
<li><a href="http://jon.doblados.net/archives.html">Archives</a></li>
            </ul>
            <div class="header_box">
                <h1><a href="http://jon.doblados.net">Jon Doblados</a></h1>
            </div>
        </div>
        <div id="wrapper">
            <div id="content">
                <h4 class="date">Feb %e,  %G</h4>
                <div class="post">
<h2 class="title">
                        <a href="http://jon.doblados.net/mysql-on-google-cloud-infrastructure-now-available.html" rel="bookmark" title="Permanent Link to &quot;MySQL on Google Cloud Infrastructure Now Available&quot;">MySQL on Google Cloud Infrastructure Now Available</a>
                    </h2>

                    <p><div
data-href="https://plus.google.com/114642277785568765419/posts/VnUU1kpqwNe"></p>
</div>

                    <div class="clear"></div>
                    <div class="info">
<a href="http://jon.doblados.net/mysql-on-google-cloud-infrastructure-now-available.html">posted at %l:03 %P</a>&nbsp;&middot;&nbsp;<a href="http://jon.doblados.net/category/misc.html" rel="tag">misc</a>
                        <div class="tags">
                            <a href="http://jon.doblados.net/tag/cloud.html">Cloud</a>
                            <a href="http://jon.doblados.net/tag/cloud-computing.html">Cloud Computing</a>
                            <a href="http://jon.doblados.net/tag/google.html">Google</a>
                            <a href="http://jon.doblados.net/tag/mysql.html" class="selected">MySQL</a>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>

                <h4 class="date">Aug %e,  %G</h4>
                <div class="post">
<h2 class="title">
                        <a href="http://jon.doblados.net/plesk-wont-start-after-tweaking-mysql.html" rel="bookmark" title="Permanent Link to &quot;plesk won't start after tweaking mysql&quot;">plesk won't start after tweaking mysql</a>
                    </h2>

                    <p>i've had this happen to me again the other week and as always, felt like
kicking myself for not remembering.</p>
<p>we do a lot of performance tuning on mysql, and as a result, we almost
always manage to get plesk mangled. not its fault, it just can't run
without mysql, doh.</p>
<p>not of preference, but plesk happens to be there to make handling
domains easier, as a single editing point when you want to change
something and not worry about missing something out.</p>
<p>so there's a custom /etc/my.cnf that we use, and with changes to limits
done (both on mysql and via ulimit), you'd think that a reload of mysqld
would do. (we use InnoDB btw)</p>
<p>normally, that's all you need to have mysqld read off the new settings.
if you've grown so dependent on plesk (like i have), you would not
notice that mysqld didn't actually start, and you will get an error when
you load plesk, thinking that it's a plesk error:</p>
<p><code>ERROR: PleskMainDBExceptionMySQL query failed: Incorrect information in file: './psa/misc.frm'</code></p>
<p>0: /usr/local/psa/admin/plib/common_func.php3:218<br />
db_query(string 'select param, val from misc')<br />
1: /usr/local/psa/admin/plib/common_func.php3:497<br />
get_param(string 'mysql41_compatible')<br />
2: /usr/local/psa/admin/plib/common_func.php3:394<br />
db_set_names()<br />
3: /usr/local/psa/admin/plib/common_func.php3:373<br />
db_connect_real(string 'localhost', string 'admin', string
'********', string 'psa')<br />
4: /usr/local/psa/admin/plib/common_func.php3:353<br />
db_connect()<br />
5: /usr/local/psa/admin/auto_prepend/auth.php3:82<br />
</code></p>
<p>even a restart of the plesk service will not work:</p>
<p><code>[root@jedi]# /etc/init.d/psa restartUnable to query parameter by query select val from misc where param='mysql41_compatible': Incorrect information in file: './psa/misc.frm'Unable to query parameter by query select val from misc where param='mysql41_compatible': Incorrect information in file: './psa/misc.frm'Mysql error: Incorrect information in file: './psa/key_history.frm'Processing config directory: /usr/local/psa/admin/conf/httpsd.*.includeSyntax OK/usr/local/psa/admin/bin/httpsdctl restart: httpd restartedERROR 1033 (HY000) at line 1: Incorrect information in file: './psa/sessions.frm'</code></p>
<p>so this is a mysqld failing to start properly problem. to fix this, go
to your mysql datadir and see if the sizes of your innodb log files
match those in your .cnf. we usually set innodb_log_file_size = 256M
and innodb_log_buffer_size = 256M in /etc/my.cnf.</p>
<p>if they don't match, stop mysqld, remove the ib_logfile0 and
ib_logfile1 files, and start mysqld. be careful not to delete the
ibdata1 or ibdata2 files or you lose your data. avoid using rm -r ib*
(yea, wildcards and fast fingers give sysads their most stupefying
moments)</p>
<p>innodb will recreate the log files to match your .cnf and mysqld now
becomes available for plesk.</p>
</p>

                    <div class="clear"></div>
                    <div class="info">
<a href="http://jon.doblados.net/plesk-wont-start-after-tweaking-mysql.html">posted at %l:09 %P</a>&nbsp;&middot;&nbsp;<a href="http://jon.doblados.net/category/misc.html" rel="tag">misc</a>
                        <div class="tags">
                            <a href="http://jon.doblados.net/tag/hosting.html">Hosting</a>
                            <a href="http://jon.doblados.net/tag/mysql.html" class="selected">MySQL</a>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>

                <h4 class="date">Jan %e,  %G</h4>
                <div class="post">
<h2 class="title">
                        <a href="http://jon.doblados.net/using-symbolic-links-for-mysql-data-files.html" rel="bookmark" title="Permanent Link to &quot;Using symbolic links for MySQL data files&quot;">Using symbolic links for MySQL data files</a>
                    </h2>

                    <p>Over a year ago, we had several servers configured for high traffic
websites. A mispartioning resulted in /var becoming obscenely small, and
it was only after MySQL crashed that we remembered this. We couldnâ€™t
afford more downtime if we dealt with the partition size problem, so I
thought of quickly moving the data files into /home/mysql/{dbname} from
/var/lib/mysql/{dbname} and create the symlink /var/lib/mysql/{dbname}
-> /home/mysql/{dbname}.</p>
<p>I was not certain of the performance implications to this. I heard from
a fellow Linux junkie here that there may be a slight penalties in terms
of access speed, since /home was meant for generic read/write, whereas
/var was accessed in a very quick manner. Gotta verify this. But for
now, I dwell in the power of symbolic links.</p>
</p>

                    <div class="clear"></div>
                    <div class="info">
<a href="http://jon.doblados.net/using-symbolic-links-for-mysql-data-files.html">posted at %l:47 %P</a>&nbsp;&middot;&nbsp;<a href="http://jon.doblados.net/category/misc.html" rel="tag">misc</a>
                        <div class="tags">
                            <a href="http://jon.doblados.net/tag/hosting.html">Hosting</a>
                            <a href="http://jon.doblados.net/tag/mysql.html" class="selected">MySQL</a>
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="clear"></div>
                <div id="footer">
                    <p>
                    Mockingbird theme by <a href="http://nevanscott.com/">Nevan Scott</a>
                    &middot;
                    <a class="atom" href="http://jon.doblados.net/None">Feed</a>
                </div>
            </div>
            <div class="clear"></div>
        </div>
    </body>
</html>