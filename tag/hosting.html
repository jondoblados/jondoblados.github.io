<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Jon Doblados - Hosting</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Jon Doblados </a></h1>
                <nav><ul>
                    <li><a href="/pages/about.html">About</a></li>
                    <li><a href="/pages/contact.html">Contact</a></li>
                    <li><a href="/category/aside.html">Aside</a></li>
                    <li><a href="/category/misc.html">Misc</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li><a href="/category/tech.html">Tech</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/how-to-count-instances-of-an-ip-address-in-a-log-file.html">How to count instances of an IP address in a log file</a></h1>
<footer class="post-info">
        <abbr class="published" title="2010-07-24T12:00:00+02:00">
                Published: Sat 24 July 2010
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/jon.html">jon</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>. </p>
<p>tags: <a href="/tag/gnulinux.html">GNU/Linux</a> <a href="/tag/hosting.html">Hosting</a> <a href="/tag/systems-administration.html">Systems Administration</a> </p>
</footer><!-- /.post-info --><p>I was looking for a quick and painless way to determine what IP
addresses used our web app the most and stumbled across this excellent
<a href="http://encodable.com/tech/blog/2008/12/17/Count_IP_Addresses_in_Access_Log_File_BASH_OneLiner">post</a>. I
got reminded of the power of the command-line interface and that often,
I underestimate the way these commands are supposed to make a sysad's
life easier.</p>
<p>So here's a quick tip for counting unique visitors to your web app.
Locate your web app's log file and do a quick scan of the last few
lines. In my case, this is what I saw:</p>
<p><code>112.198.79.223 - - [10/Jul/2010:00:57:29 -0400] "POST /v2/api/execute.php?method=upload_time&amp;ver=win1.1.15 HTTP/1.1" 200 116 "-" "Mozilla/5.0"117.241.112.254 - - [10/Jul/2010:00:57:30 -0400] "POST /v2/api/execute.php?method=timestat&amp;ver=win1.1.15 HTTP/1.1" 200 288 "-" "Mozilla/5.0"80.249.84.105 - - [10/Jul/2010:00:57:29 -0400] "POST /v2/api/execute.php?method=offtime&amp;ver=win1.1.15 HTTP/1.1" 200 19 "-" "Mozilla/5.0"117.241.112.254 - - [10/Jul/2010:00:57:32 -0400] "POST /v2/api/execute.php?method=get_defaults&amp;ver=win1.1.15 HTTP/1.1" 200 77 "-" "Mozilla/5.0"</code></p>
<p>In this log format, the IP address appears first, so we will only need
to get the first set of characters, separated by a space. In order to
count instances of an IP address, we sort the IP addresses so similar IP
addresses are grouped together, then count them. Then we sort them again
so that the sums are arranged. The number of unique IPs may give you
pages of standard output, so optionally, if you only want to see which
IP addresses accessed the web app the most, we look at the top results
only.</p>
<p>So these are the commands used, piped one after the other, with the
output:</p>
<p><code>[root@server2 ~]# cat /var/log/httpd/access_ssl.log | awk '{print $1}' | sort | uniq -c | sort -nr | head&gt;</code></p>
<p><code>71612 216.157.78.237 34094 120.28.205.244 30091 119.93.97.54 25078 120.28.214.104 18949 120.28.195.151 17929 58.107.64.40 14877 212.98.174.235 14752 117.241.112.143 14429 120.28.247.74 12864 117.241.113.183 [root@server2 ~]#</code></p>
<p>Happy counting, err reporting!</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/plesk-wont-start-after-tweaking-mysql.html" rel="bookmark"
                           title="Permalink to plesk won't start after tweaking mysql">plesk won't start after tweaking mysql</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2007-08-14T04:09:00+02:00">
                Published: Tue 14 August 2007
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/jon.html">jon</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>. </p>
<p>tags: <a href="/tag/hosting.html">Hosting</a> <a href="/tag/mysql.html">MySQL</a> </p>
</footer><!-- /.post-info -->                <p>i've had this happen to me again the other week and as always, felt like
kicking myself for not remembering.</p>
<p>we do a lot of performance tuning on mysql, and as a result, we almost
always manage to get plesk mangled. not its fault, it just can't run ...</p>
                <a class="readmore" href="/plesk-wont-start-after-tweaking-mysql.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/ip-hijacking-and-then-some.html" rel="bookmark"
                           title="Permalink to IP-hijacking and then some">IP-hijacking and then some</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2007-02-25T11:51:00+01:00">
                Published: Sun 25 February 2007
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/jon.html">jon</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>. </p>
<p>tags: <a href="/tag/domains.html">Domains</a> <a href="/tag/hosting.html">Hosting</a> </p>
</footer><!-- /.post-info -->                <p>Almost a month of downtime. The servers were fine, but our IP addresses
were not. Somehow, a system bug from one of the hosting companies caused
our plan to include 14 other IP addresses, and we only maintained 6 as
far as I am concerned.</p>
<p>So the hosting company eventually ...</p>
                <a class="readmore" href="/ip-hijacking-and-then-some.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/using-symbolic-links-for-mysql-data-files.html" rel="bookmark"
                           title="Permalink to Using symbolic links for MySQL data files">Using symbolic links for MySQL data files</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2007-01-16T08:47:00+01:00">
                Published: Tue 16 January 2007
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/jon.html">jon</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>. </p>
<p>tags: <a href="/tag/hosting.html">Hosting</a> <a href="/tag/mysql.html">MySQL</a> </p>
</footer><!-- /.post-info -->                <p>Over a year ago, we had several servers configured for high traffic
websites. A mispartioning resulted in /var becoming obscenely small, and
it was only after MySQL crashed that we remembered this. We couldn’t
afford more downtime if we dealt with the partition size problem, so I
thought of ...</p>
                <a class="readmore" href="/using-symbolic-links-for-mysql-data-files.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 1
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>